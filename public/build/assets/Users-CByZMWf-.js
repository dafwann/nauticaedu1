import{_ as H,c as o,a as s,h as c,i as k,k as J,y as p,t as n,d as W,e as X,b as U,r as Y,z as D,F as N,f as I,n as Z,w as $,p as d,q as P,s as tt,o as r}from"./app-Bfj2fJZ6.js";import{a as L}from"./index-B9ygI19o.js";const et={name:"AdminUsers",setup(){const f=d([]),t=d(null),A=d(!1),e=d(""),y=d(""),C=d(""),i=d("created_at"),l=d("desc"),g=d([]),B=d(!1),v=d(1),S=10,E=async()=>{A.value=!0;try{const a=await L.get("/api/users");f.value=a.data.data}catch(a){console.error("Error fetching users:",a)}finally{A.value=!1}},O=a=>{t.value={...a}},R=()=>{t.value=null},T=async()=>{try{const a=await L.patch(`/api/users/${t.value.id}/status`,{status:t.value.status}),u=f.value.findIndex(x=>x.id===t.value.id);u!==-1&&(f.value[u]=a.data.data),t.value=null}catch(a){console.error("Error updating status:",a),alert("Gagal mengubah status")}},_=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}),w=P(()=>{let a=f.value;if(e.value){const u=e.value.toLowerCase();a=a.filter(x=>x.username.toLowerCase().includes(u))}return y.value&&(a=a.filter(u=>u.status===y.value)),C.value&&(a=a.filter(u=>u.role===C.value)),a=a.sort((u,x)=>{let m=u[i.value],b=x[i.value];return i.value==="username"||i.value==="email"||i.value==="role"||i.value==="status"?(m=m.toLowerCase(),b=b.toLowerCase()):i.value==="created_at"&&(m=new Date(m),b=new Date(b)),m<b?l.value==="asc"?-1:1:m>b?l.value==="asc"?1:-1:0}),a}),h=P(()=>Math.ceil(w.value.length/S)),F=P(()=>(v.value-1)*S),M=P(()=>Math.min(F.value+S,w.value.length)),V=P(()=>w.value.slice(F.value,M.value)),Q=()=>{v.value<h.value&&v.value++},q=()=>{v.value>1&&v.value--},z=a=>{v.value=a},G=a=>{i.value===a?l.value=l.value==="asc"?"desc":"asc":(i.value=a,l.value="asc")},K=()=>{e.value="",y.value="",C.value="",v.value=1},j=()=>{B.value?g.value=V.value.map(a=>a.id):g.value=[]};return tt(()=>{E()}),{users:f,editingUser:t,loading:A,searchQuery:e,statusFilter:y,roleFilter:C,sortBy:i,sortOrder:l,selectedUsers:g,selectAll:B,currentPage:v,itemsPerPage:S,filteredUsers:w,paginatedUsers:V,totalPages:h,startIndex:F,endIndex:M,fetchUsers:E,editUser:O,cancelEdit:R,saveStatus:T,formatDate:_,sortUsers:G,clearFilters:K,nextPage:Q,prevPage:q,goToPage:z,toggleSelectAll:j}}},st={class:"admin-users"},lt={class:"filters-section"},at={class:"filters-content"},nt={class:"search-box"},ot={class:"filter-controls"},rt={class:"table-section"},it={class:"table-container"},dt={class:"table-header"},ut={class:"table-info"},vt={class:"table-actions"},ct=["disabled"],gt={class:"table-wrapper"},ft={class:"users-table"},mt={key:0,class:"sort-icon"},bt={key:0,class:"sort-icon"},kt={key:0,class:"sort-icon"},Ut={key:0,class:"sort-icon"},yt={key:0,class:"sort-icon"},Ct=["value"],xt=["onClick"],Pt={key:0,class:"empty-state"},At={key:0,class:"pagination"},St={class:"pagination-info"},wt={class:"pagination-controls"},Ft=["disabled"],pt={class:"page-numbers"},Bt=["onClick"],Et=["disabled"],ht={class:"modal-header"},Mt={class:"modal-body"},Vt={class:"modal-footer"};function Dt(f,t,A,e,y,C){const i=Y("router-link");return r(),o("div",st,[t[38]||(t[38]=s("div",{class:"page-header"},[s("div",{class:"header-content"},[s("div",{class:"header-text"},[s("h1",null,"ðŸ‘¥ Management Pengguna"),s("p",null,"Kelola data pengguna dan akses sistem")])])],-1)),s("div",lt,[s("div",at,[s("div",nt,[k(s("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.searchQuery=l),type:"text",placeholder:"Cari pengguna...",class:"search-input"},null,512),[[J,e.searchQuery]]),t[22]||(t[22]=s("span",{class:"search-icon"},"ðŸ”",-1))]),s("div",ot,[k(s("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>e.statusFilter=l),class:"filter-select"},[...t[23]||(t[23]=[s("option",{value:""},"Semua Status",-1),s("option",{value:"aktif"},"Aktif",-1),s("option",{value:"non-aktif"},"Non-Aktif",-1)])],512),[[p,e.statusFilter]]),k(s("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>e.roleFilter=l),class:"filter-select"},[...t[24]||(t[24]=[s("option",{value:""},"Semua Role",-1),s("option",{value:"user"},"User",-1),s("option",{value:"admin"},"Admin",-1)])],512),[[p,e.roleFilter]]),s("button",{onClick:t[3]||(t[3]=(...l)=>e.clearFilters&&e.clearFilters(...l)),class:"btn-clear"}," ðŸ—‘ï¸ Clear ")])])]),s("div",rt,[s("div",it,[s("div",dt,[s("div",ut," Menampilkan "+n(e.paginatedUsers.length)+" dari "+n(e.filteredUsers.length)+" user ",1),s("div",vt,[W(i,{to:"/reset-password",class:"refreshi-btn reseti-btn"},{default:X(()=>[...t[25]||(t[25]=[U(" Reset Password ",-1)])]),_:1}),s("button",{onClick:t[4]||(t[4]=(...l)=>e.fetchUsers&&e.fetchUsers(...l)),class:"refreshi-btn",disabled:e.loading},n(e.loading?"ðŸ”„...":"ðŸ”„ Refresh"),9,ct)])]),s("div",gt,[s("table",ft,[s("thead",null,[s("tr",null,[s("th",null,[k(s("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=l=>e.selectAll=l),onChange:t[6]||(t[6]=(...l)=>e.toggleSelectAll&&e.toggleSelectAll(...l))},null,544),[[D,e.selectAll]])]),s("th",{onClick:t[7]||(t[7]=l=>e.sortUsers("username")),class:"sortable"},[t[26]||(t[26]=U(" Username ",-1)),e.sortBy==="username"?(r(),o("span",mt,n(e.sortOrder==="asc"?"â†‘":"â†“"),1)):c("",!0)]),s("th",{onClick:t[8]||(t[8]=l=>e.sortUsers("email")),class:"sortable"},[t[27]||(t[27]=U(" Email ",-1)),e.sortBy==="email"?(r(),o("span",bt,n(e.sortOrder==="asc"?"â†‘":"â†“"),1)):c("",!0)]),s("th",{onClick:t[9]||(t[9]=l=>e.sortUsers("role")),class:"sortable"},[t[28]||(t[28]=U(" Role ",-1)),e.sortBy==="role"?(r(),o("span",kt,n(e.sortOrder==="asc"?"â†‘":"â†“"),1)):c("",!0)]),s("th",{onClick:t[10]||(t[10]=l=>e.sortUsers("status")),class:"sortable"},[t[29]||(t[29]=U(" Status ",-1)),e.sortBy==="status"?(r(),o("span",Ut,n(e.sortOrder==="asc"?"â†‘":"â†“"),1)):c("",!0)]),s("th",{onClick:t[11]||(t[11]=l=>e.sortUsers("created_at")),class:"sortable"},[t[30]||(t[30]=U(" Bergabung ",-1)),e.sortBy==="created_at"?(r(),o("span",yt,n(e.sortOrder==="asc"?"â†‘":"â†“"),1)):c("",!0)]),t[31]||(t[31]=s("th",null,"Aksi",-1))])]),s("tbody",null,[(r(!0),o(N,null,I(e.paginatedUsers,l=>(r(),o("tr",{key:l.id},[s("td",null,[k(s("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=g=>e.selectedUsers=g),value:l.id},null,8,Ct),[[D,e.selectedUsers]])]),s("td",null,n(l.username),1),s("td",null,n(l.email),1),s("td",null,n(l.role==="admin"?"Admin":"User"),1),s("td",null,n(l.status==="aktif"?"Aktif":"Non-Aktif"),1),s("td",null,n(e.formatDate(l.created_at)),1),s("td",null,[s("button",{onClick:g=>e.editUser(l),class:"btn-action edit"},"âœï¸ Ubah Status",8,xt)])]))),128))])]),e.filteredUsers.length===0?(r(),o("div",Pt,[t[32]||(t[32]=s("div",{class:"empty-icon"},"ðŸ‘¥",-1)),t[33]||(t[33]=s("h3",null,"Tidak ada pengguna ditemukan",-1)),t[34]||(t[34]=s("p",null,"Coba ubah filter pencarian atau tambah pengguna baru",-1)),s("button",{onClick:t[13]||(t[13]=(...l)=>e.clearFilters&&e.clearFilters(...l)),class:"btn-primary"}," ðŸ”„ Reset Filter ")])):c("",!0)]),e.filteredUsers.length>e.itemsPerPage?(r(),o("div",At,[s("div",St," Menampilkan "+n(e.startIndex+1)+"-"+n(e.endIndex)+" dari "+n(e.filteredUsers.length)+" user ",1),s("div",wt,[s("button",{onClick:t[14]||(t[14]=(...l)=>e.prevPage&&e.prevPage(...l)),disabled:e.currentPage===1,class:"pagination-btn"},"â† Prev",8,Ft),s("div",pt,[(r(!0),o(N,null,I(e.totalPages,l=>(r(),o("button",{key:l,onClick:g=>e.goToPage(l),class:Z([{active:e.currentPage===l},"page-btn"])},n(l),11,Bt))),128))]),s("button",{onClick:t[15]||(t[15]=(...l)=>e.nextPage&&e.nextPage(...l)),disabled:e.currentPage===e.totalPages,class:"pagination-btn"},"Next â†’",8,Et)])])):c("",!0)])]),e.editingUser?(r(),o("div",{key:0,class:"modal-backdrop",onClick:t[21]||(t[21]=(...l)=>e.cancelEdit&&e.cancelEdit(...l))},[s("div",{class:"modal",onClick:t[20]||(t[20]=$(()=>{},["stop"]))},[s("div",ht,[t[35]||(t[35]=s("h3",null,"âœï¸ Ubah Status Pengguna",-1)),s("button",{onClick:t[16]||(t[16]=(...l)=>e.cancelEdit&&e.cancelEdit(...l)),class:"modal-close"},"Ã—")]),s("div",Mt,[t[37]||(t[37]=s("label",null,"Status",-1)),k(s("select",{"onUpdate:modelValue":t[17]||(t[17]=l=>e.editingUser.status=l),class:"form-select"},[...t[36]||(t[36]=[s("option",{value:"aktif"},"Aktif",-1),s("option",{value:"non-aktif"},"Non-Aktif",-1)])],512),[[p,e.editingUser.status]])]),s("div",Vt,[s("button",{onClick:t[18]||(t[18]=(...l)=>e.cancelEdit&&e.cancelEdit(...l)),class:"btn-secondary"},"Batal"),s("button",{onClick:t[19]||(t[19]=(...l)=>e.saveStatus&&e.saveStatus(...l)),class:"btn-primary"},"Simpan")])])])):c("",!0)])}const Lt=H(et,[["render",Dt],["__scopeId","data-v-73fadd72"]]);export{Lt as default};
